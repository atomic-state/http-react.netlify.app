import { Callout } from 'nextra-theme-docs'

# SSR

Server-side-rendering is supported out-of-the-box. When you set a [`default`](/docs/api#default) value in `useFetch`, it will also be server-side-rendered.

`HttpReact` can also be used imperatively like [`Axios`](https://axios-http.com/docs/intro) and has an `extend` property (the equivalent to `axios.create`)

Example using Next.js's [`getServerSideProps`](https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props):

```jsx
import useFetch, { HttpReact } from 'http-react'

// You should use this, it works inside server components
const Client = HttpReact.extend({
  baseUrl: 'https://my-api.com',
  headers: {
    Authorization: 'Token etc'
  }
})

export async function getServerSideProps(context) {
  // 'loading' does not work here
  const { data } = await Client.get('/api/user')

  return {
    props: {
      user: data
    } // will be passed to the page component as props
  }
}

export default function MyPage({ user }) {
  const { data } = useFetch('/api/user', {
    default: user
  })

  return (
    <div>
      <h2>Welcome, {data.name}</h2>
    </div>
  )
}
```

#### With Server Components in Next.js:

This part covers server-side rendering with Next.js ^13.0.0 (with server components)

Inside the main layout as a server component:

```js filename="app/layout.tsx" {5}
import { cookies } from 'next/headers'

import Login from 'components/Login'

import { FetchConfig, HttpReact } from 'http-react'

const Client = HttpReact.extend({
  baseUrl: 'https://my-website.com/api'
})

export default async function Layout({ children }) {
  // This is only works in server components!
  const appSession = cookies().get('appSession')?.value

  // This works everywhere
  const { data, error } = await Client.get('/auth', {
    headers: {
      Authorization: 'Token ' + appSession
    }
  })

  if (error) return <Login />

  return (
    <FetchConfig
      headers={{
        // Will be sent in subsequent requests
        Authorization: 'Token ' + appSession
      }}
      defaults={{
        'GET /api/profile': {
          value: data // This will be ssr!
        }
      }}
    >
      {children}
    </FetchConfig>
  )
}
```

Inside a `pages/profile.tsx`:

```jsx filename="app/profile.tsx"
'use client' // This marks this component as a client component
import useFetch from 'http-react'

export default function Profile() {
  const { data } = useFetch('/api/profile')

  return (
    <div>
      <h2>Name: {data.name}</h2>
    </div>
  )
}
```

<Callout type='info'>
  Learn more -> [Server and Client
  Components](https://beta.nextjs.org/docs/rendering/server-and-client-components)
</Callout>
